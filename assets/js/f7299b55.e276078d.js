"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[902],{9497:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>r});var s=t(4848),i=t(8453);const a={id:"using-matchers",title:"Using Matchers"},c=void 0,o={id:"using-matchers",title:"Using Matchers",description:'Jest Lua uses "matchers" to let you test values in different ways. This document will introduce some commonly used matchers. For the full list, see the expect API doc.',source:"@site/docs/UsingMatchers.md",sourceDirName:".",slug:"/using-matchers",permalink:"/jest-lua/using-matchers",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"using-matchers",title:"Using Matchers"},sidebar:"docs",previous:{title:"Getting Started",permalink:"/jest-lua/"},next:{title:"Testing Asynchronous Code",permalink:"/jest-lua/asynchronous"}},l={},r=[{value:"Common Matchers",id:"common-matchers",level:2},{value:"Truthiness",id:"truthiness",level:2},{value:"Numbers",id:"numbers",level:2},{value:"Strings",id:"strings",level:2},{value:"Tables",id:"tables",level:2},{value:"Exceptions",id:"exceptions",level:2},{value:"And More",id:"and-more",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:(0,s.jsx)("a",{href:"https://jestjs.io/docs/27.x/using-matchers",target:"_blank",children:(0,s.jsx)("img",{alt:"Jest",src:"img/jestjs.svg"})})}),"\n",(0,s.jsxs)(n.p,{children:['Jest Lua uses "matchers" to let you test values in different ways. This document will introduce some commonly used matchers. For the full list, see the ',(0,s.jsxs)(n.a,{href:"expect",children:[(0,s.jsx)(n.code,{children:"expect"})," API doc"]}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"common-matchers",children:"Common Matchers"}),"\n",(0,s.jsx)(n.p,{children:"The simplest way to test a value is with exact equality."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('two plus two is four', function()\n\texpect(2 + 2).toBe(4)\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In this code, ",(0,s.jsx)(n.code,{children:"expect(2 + 2)"}),' returns an "expectation" object. You typically won\'t do much with these expectation objects except call matchers on them. In this code, ',(0,s.jsx)(n.code,{children:".toBe(4)"})," is the matcher. When Jest Lua runs, it tracks all the failing matchers so that it can print out nice error messages for you."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"toBe"})," tests exact equality. If you want to check the value of an object, use ",(0,s.jsx)(n.code,{children:"toEqual"})," instead:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('object assignment', function()\n\tlocal data = { one = 1 }\n\tdata['two'] = 2\n\texpect(data).toEqual({one = 1, two = 2})\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"toEqual"})," recursively checks every field of a table."]}),"\n",(0,s.jsx)(n.p,{children:"You can also test for the opposite of a matcher:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('adding positive numbers is not zero', function()\n\texpect(1 + 2).never.toBe(0)\nend)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"truthiness",children:"Truthiness"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Deviation",src:t(8105).A+"",width:"63",height:"20"})}),"\n",(0,s.jsxs)(n.p,{children:["In tests, you sometimes need to distinguish between ",(0,s.jsx)(n.code,{children:"nil"}),", and ",(0,s.jsx)(n.code,{children:"false"}),", but you sometimes do not want to treat these differently. Jest Lua contains helpers that let you be explicit about what you want."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeNil"})," matches only ",(0,s.jsx)(n.code,{children:"nil"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeTruthy"})," matches anything that an ",(0,s.jsx)(n.code,{children:"if"})," statement treats as ",(0,s.jsx)(n.code,{children:"true"})," (anything but ",(0,s.jsx)(n.code,{children:"false"})," and ",(0,s.jsx)(n.code,{children:"nil"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeFalsy"})," matches anything that an ",(0,s.jsx)(n.code,{children:"if"})," statement treats as ",(0,s.jsx)(n.code,{children:"false"})," (",(0,s.jsx)(n.code,{children:"false"})," and ",(0,s.jsx)(n.code,{children:"nil"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The following are identical to the ones above but are provided for the sake of completeness:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeUndefined"})," is identical to ",(0,s.jsx)(n.code,{children:"toBeNil"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeNull"})," is an alias of ",(0,s.jsx)(n.code,{children:"toBeNil"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"toBeDefined"})," is identical to ",(0,s.jsx)(n.code,{children:"never.toBeNil"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('nil', function()\n\tlocal n = nil\n\texpect(n).toBeNil()\n\texpect(n).never.toBeTruthy()\n\texpect(n).toBeFalsy()\nend)\n\nit('false', function()\n\tlocal z = false\n\texpect(z).never.toBeNull()\n\texpect(z).never.toBeTruthy()\n\texpect(z).toBeFalsy()\nend)\n"})}),"\n",(0,s.jsx)(n.p,{children:"You should use the matcher that most precisely corresponds to what you want your code to be doing."}),"\n",(0,s.jsx)(n.h2,{id:"numbers",children:"Numbers"}),"\n",(0,s.jsx)(n.p,{children:"Most ways of comparing numbers have matcher equivalents."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('two plus two', function()\n\tlocal value = 2 + 2\n\texpect(value).toBeGreaterThan(3)\n\texpect(value).toBeGreaterThanOrEqual(3.5)\n\texpect(value).toBeLessThan(5)\n\texpect(value).toBeLessThanOrEqual(4.5)\n\n\t-- toBe and toEqual are equivalent for numbers\n\texpect(value).toBe(4)\n\texpect(value).toEqual(4)\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For floating point equality, use ",(0,s.jsx)(n.code,{children:"toBeCloseTo"})," instead of ",(0,s.jsx)(n.code,{children:"toEqual"}),", because you don't want a test to depend on a tiny rounding error."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('adding floating point numbers', function()\n\tlocal value = 0.1 + 0.2\n\texpect(value).toBeCloseTo(0.3)\nend)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"strings",children:"Strings"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"API Change",src:t(1720).A+"",width:"73",height:"20"})}),"\n",(0,s.jsxs)(n.p,{children:["You can check strings against ",(0,s.jsx)(n.a,{href:"https://developer.roblox.com/en-us/articles/string-patterns-reference",children:"Lua string patterns"})," with ",(0,s.jsx)(n.code,{children:"toMatch"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('there is no I in team', function()\n\texpect('team').never.toMatch('I')\nend)\n\nit('but there is a \"stop\" in Christoph', function()\n\texpect('Christoph').toMatch('stop')\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also check strings against a regular expression using ",(0,s.jsxs)(n.a,{href:"expect#regexp",children:[(0,s.jsx)(n.code,{children:"RegExp"})," from LuauRegExp"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('Christoph ends in \"oph\"', function()\n\texpect('Christoph').toMatch(RegExp('oph$'))\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can check if a string contains an exact substring using ",(0,s.jsx)(n.code,{children:"toContain"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('there is a \"stop\" in Christoph', function()\n\texpect('Christoph').toContain('stop')\nend)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tables",children:"Tables"}),"\n",(0,s.jsxs)(n.p,{children:["You can check if an array contains a particular item using ",(0,s.jsx)(n.code,{children:"toContain"})," or that a string contains a particular substring:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"local shoppingList = {\n\t'diapers',\n\t'kleenex',\n\t'trash bags',\n\t'paper towels',\n\t'beer',\n}\n\nit('the shopping list has beer on it', function()\n\texpect(shoppingList).toContain('beer')\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"toContain"})," performs a shallow equality so if you need to check that a specific table exists within the array, use ",(0,s.jsx)(n.code,{children:".toContainEqual"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"local shoppingList = {\n\t{'milk', 4},\n\t{'bananas', 10},\n\t{'beer', 1},\n}\n\nit('the shopping list contains {\"beer\", 1}', function()\n\texpect(shoppingList).toContainEqual({'beer', 1})\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also check that a table is equal to another table by using ",(0,s.jsx)(n.code,{children:"toEqual"}),". This recursively compares all properties of the tables."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"local inventory = {\n\tlacroix = {\n\t\tpamplemousse = 3,\n\t\tpassionfruit = 10,\n\t},\n\tbeer = {\n\t\tbudweiser = 3,\n\t}\n}\n\nit('the inventory matches', function()\n\texpect(inventory.lacroix).toEqual({\n\t\tlacroix = {\n\t\t\tpamplemousse = 3,\n\t\t\tpassionfruit = 10,\n\t\t},\n\t\tbeer = {\n\t\t\tbudweiser = 3,\n\t\t}\n\t})\nend)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Lastly, you can check that a table has a property and value by using ",(0,s.jsx)(n.code,{children:".toHaveProperty"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"it('the inventory has 3 budweisers', function()\n\texpect(inventory).toHaveProperty('beer.budweiser', 3)\nend)\n\nit('the inventory does not have guinness', function()\n\texpect(inventory).never.toHaveProperty('beer.guinness')\nend)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"exceptions",children:"Exceptions"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"API Change",src:t(1720).A+"",width:"73",height:"20"})}),"\n",(0,s.jsxs)(n.p,{children:["If you want to test whether a particular function throws an error when it's called, use ",(0,s.jsx)(n.code,{children:"toThrow"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function thisFunctionErrors()\n\terror('oh no')\nend\n\nit('the function errors', function()\n\texpect(thisFunctionErrors).toThrow()\n\n\t-- You can also use the exact error message or a RegExp using the LuauRegExp library\n\texpect(thisFunctionErrors).toThrow('oh no')\n\texpect(thisFunctionErrors).toThrow(RegExp('no'))\nend)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"and-more",children:"And More"}),"\n",(0,s.jsxs)(n.p,{children:["This is just a taste. For a complete list of matchers, check out the ",(0,s.jsx)(n.a,{href:"expect",children:"reference docs"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1720:(e,n,t)=>{t.d(n,{A:()=>s});const s="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNzMiIGhlaWdodD0iMjAiIHJvbGU9ImltZyIgYXJpYS1sYWJlbD0iQVBJIGNoYW5nZSI+PHRpdGxlPkFQSSBjaGFuZ2U8L3RpdGxlPjxnIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyI+PHJlY3Qgd2lkdGg9IjczIiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmZjMTA3Ii8+PC9nPjxnIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJWZXJkYW5hLEdlbmV2YSxEZWphVnUgU2FucyxzYW5zLXNlcmlmIiB0ZXh0LXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIiBmb250LXNpemU9IjExMCI+PHRleHQgeD0iMzYyIiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjMzMzIiB0ZXh0TGVuZ3RoPSI2MzAiPkFQSSBjaGFuZ2U8L3RleHQ+PC9nPjwvc3ZnPg=="},8105:(e,n,t)=>{t.d(n,{A:()=>s});const s="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjMiIGhlaWdodD0iMjAiIHJvbGU9ImltZyIgYXJpYS1sYWJlbD0iRGV2aWF0aW9uIj48dGl0bGU+RGV2aWF0aW9uPC90aXRsZT48ZyBzaGFwZS1yZW5kZXJpbmc9ImNyaXNwRWRnZXMiPjxyZWN0IHdpZHRoPSI2MyIgaGVpZ2h0PSIyMCIgZmlsbD0iI2NjMDAwMCIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iVmVyZGFuYSxHZW5ldmEsRGVqYVZ1IFNhbnMsc2Fucy1zZXJpZiIgdGV4dC1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgZm9udC1zaXplPSIxMTAiPjx0ZXh0IHg9IjMxNiIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgZmlsbD0iI2ZmZiIgdGV4dExlbmd0aD0iNTMwIj5EZXZpYXRpb248L3RleHQ+PC9nPjwvc3ZnPg=="},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var s=t(6540);const i={},a=s.createContext(i);function c(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);